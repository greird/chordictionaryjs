import{WORDING}from"./wordings";import{NOTES}from"./notes";import{removeDuplicates,arrayFind}from"./tools";import*as INTERVAL from"./interval";export function isValid(t){return!!new RegExp("^[x0-9]*$","i").test(t)}export function parse(t,e){e=e||"EADGBE";let r=[];if((t=t.toLowerCase()).length<=e.length)return t.split("");if(t.length===2*e.length){for(let e=0;e<t.length;e++)e%2||r.push(t.slice(e,e+2));return r}if(t.length>e.length){if(arrayFind(t.split(""),"max")>1){for(let e=0;e<t.length;e++)-1!==t.charAt(e).search(/[x02-9]/i)||1===t.charAt(e)&&-1!==t.charAt(e+1).search(/x/i)?r.push(t.slice(e,e+1)):-1===t.charAt(e+1).search(/x/i)&&(r.push(t.slice(e,e+2)),e++);return r}throw WORDING.invalidTab}return!1}export function toNotes(t,e){let r,n,i=[];for(let o=0;o<t.length;o++)isNaN(t[o])?i.push("x"):(n=e[o],(r=parseInt(t[o])+NOTES.indexOf(n))>NOTES.length-1&&(r-=NOTES.length),i.push(NOTES[r]));return i}export function getSemitones(t){let e=[];for(let n=0;n<t.length;n++){var r=[];if(t[n]&&"x"!==t[n].toLowerCase()){for(let e=0;e<t.length;e++){if(!t[e]||"x"===t[e].toLowerCase()){r.push(null);continue}let i=INTERVAL.get(t[n],t[e]);r.push(i)}r.includes(0)&&e.push(r)}}return e}export function stripFormula(t){let e=[...t];return e=e.filter(t=>!isNaN(t)&&null!=t),removeDuplicates(e.sort(function(t,e){return t-e}))}